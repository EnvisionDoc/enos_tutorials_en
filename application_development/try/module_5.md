# Module 5. Using EnOS API SDK

EnOS System provides an API SDK to support the development of your application. EnOS API SDK supports Java programming language, which enables API request URL assembling, signature generation, response parsing, and APP performance optimization.

This learning module aims to help you learn how to prepare the development environment and use EnOS API SDK to call EnOS API.

## Environment preparation

- To use EnOS API SDK, a service account (accessKey and secretKey) is required. The service account is generated by creating an application on the Application Management page of EnOS Developer Center.

- Ensure that device resources are available for your organization before calling APIs toÂ interact with the data in the EnOS Cloud.  

- EnOS API SDK requires JDK1.7.0 and above version.


## Installing EnOS API SDK

EnOS API SDK can be downloaded from the **EnOS Developer Center Homepage** > **SDK Download** page. You can install EnOS API SDK by directly modifying the Maven project file *pom.xml* or by importing the JAR package file to the IDE.

### Configuring Maven
If you use Maven to manage Java projects, you can add Maven denpendency in the *pom.xml* file to install EnOS API SDK. See the following sample:

```java
<dependency>
  <groupId>com.envisioniot</groupId>
  <artifactId>enos-api-v2</artifactId>
  <version>0.0.3</version>
</dependency>
```

###Importing JAR package in IDE

If you use Eclipse or IntelliJ as integrated development environment, you can install EnOS API SDK by importing the JAR package file to the IDE.

For Eclipse, take the following steps:

1. Download the *enos-api-v2-x.x.x.jar* file and copy it to your project folder.

2. Open your project in Eclipse, right-click the project, and select **Properties**.

3. In the pop-up window, select **Java Build Path** > **Libraries** > **Add JARs** to import the downloaded JAR file.

4. Click **Apply**.

For IntelliJ, take the following steps:

1. Download the *enos-api-v2-x.x.x.jar* file and copy it to your project folder.

2. Open your project in IntelliJ, and select **File** > **Project Structure** from the menu bar.

3. Click **Apply** > **OK**.

## Using EnOS API SDK

Take the following major steps to use EnOS API SDK to call an API.

1. Retrieve service account and secret, EnOSDefaultClient.

   ```
   String serverUrl = "http://10.24.19.84:8080/enosapi";
   String accessKey = "ef56ab2a-8d90-4540-a177-272614aca039";
   String secretKey = "963C37CBD936986D42E2799AF81156D7";
   int connectTimeout = 5000; //Set connect timeout as 5000 milliseconds
   int readTimeout = 5000;    //Set read timeout as 5000 milliseconds
   EnOSDefaultClient client = new EnOSDefaultClient(serverUrl, accessKey,secretKey,connectTimeout,readTimeout);
   ```

2. Build and execute the request. Take *getPolicy* API as an example:

   ```
   GetPolicyRequest request = new GetPolicyRequest(policyId, orgId);
   EnOSResponse<Policy> response = client.execute(request);
   ```

3. When executing the request, the SDK will generate the signature using the request parameters, include the signature in the request URL as well, and send the request to the API server. When the request is prcesses, parse the response by calling response.getXXX().

   ```
   String status = response.getStatus()
   ```

### Code sample

The following sample code is for querying ECS instance of specific area.

```java
import com.envisioniot.enos.enosapi.api.request.connectservice.CreateProductRequest;
import com.envisioniot.enos.enosapi.api.resource.connectservice.Product;
import com.envisioniot.enos.enosapi.common.exception.EnOSApiException;
import com.envisioniot.enos.enosapi.common.response.EnOSResponse;
import com.envisioniot.enos.enosapi.sdk.client.EnOSDefaultClient;

public class Main {
    public static void main(String[] args) {
    String serverUrl = "http://10.24.19.84:8080/enosapi";
    String accessKey = "ef56ab2a-8d90-4540-a177-272614aca039";
    String secretKey = "963C37CBD936986D42E2799AF81156D7";
    int connectTimeout = 5000;
    int readTimeout = 5000;
    product.setProductName("XXX");
    product.setProductDesc("XXX");
    product.setModelId("XXXXX");
    product.setDataType(1);
    product.setNodeType(1);
    EnOSDefaultClient client = new EnOSDefaultClient(serverUrl, accessKey,secretKey,connectTimeout,readTimeout);
    Product product = new Product();
    CreateProductRequest request = new CreateProductRequest(orgId, product);
    try {
        EnOSResponse response = client.defaultClient().execute(request);
    } catch (EnOSApiException e) {
        e.printStackTrace();
    }
 }
    }
```
